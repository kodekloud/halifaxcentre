
<div class="page-header">
  <h1>The Latest</h1>
  <div class="submenu">
      <ul>
        <li><a href="/the_latest">All the Latest</a></li>
        <li><a href="/programs">Programs</a></li>
        <li class="current_page_item"><a href="/promotions">Store Sales and Events</a></li>
        <li><a href="/events">HSC Events</a></li>
        <li><a href="/contests">Contests</a></li>
        <li><a href="/news">News</a></li>
      </ul>
  </div>
  
</div>
                  
            <div id="promotions_not_empty_section">
                <ul class="promotion-list " id="promotion_list">
                    <h2>Loading Promotions...<img style="width:30px; height:30px;" src="http://kodekloud.s3.amazonaws.com/sites/5438407c6e6f64462d020000/f94e1c94989b31e20c66f9d548566e4e/loading.gif"></h2>
                
                </ul>
            </div>
            <script id="promotion_item_template" type="x-tmpl-mustache">
                
                <li class="promotion-list-item hidden-phone row">
                    <a name="{{promotionable_name}}"></a>
                    <div class="promo-image col-xs-3">
                        
                            <img src="{{store_img}}" style="width:100%">
                        
                    </div>
                    <div class="promo-details col-xs-9">
                     <div class="store-name">
                            <h3><a href="{{ promotionable_url }}">{{ promotionable_name }}</a></h3>
                        </div>
                        <div class="name">
                            <h4><a href="../promotions/{{ slug }}">{{ name }}</a></h4>
                        </div>
                       
                        <div class="dates">
                            {{ start_date }} to {{ end_date }}
                        </div>
                        <div class="promotion-more">
                           <a href="../promotions/{{ slug }}">read more</a>
                        </div>
                        <div class="social-links">
                            <span class="social-share">share:</span>
                         <span><a href="http://www.facebook.com/sharer.php?u=http://halifaxcentre.kodekloud.io/promotions/{{slug}}" target="_blank"><img src="https://testbucketblurt.s3-us-west-2.amazonaws.com/sites/54205e6a6a616d39c5860000/251f914efb0a8216e2cd28dd4834e614/share_fb.png"></a></span>
                                        <span><a href="http://twitter.com/?status={{name}}%20%20http://halifaxcentre.kodekloud.io/promotions/{{slug}}" target="_blank"><img src="https://testbucketblurt.s3-us-west-2.amazonaws.com/sites/54205e6a6a616d39c5860000/251f914efb0a8216e2cd28dd4834e614/share_twit.png"></a></span>
                         </div>
                    </div>
                </li>
                <li class="promotion-list-item visible-phone row">
                    <a name="{{promotionable_name}}"></a>
                    <div class="promo-image col-xs-12">
                        <a href="../promotions/{{ slug }}">
                            <img src="{{promo_image_url_abs}}" style="width:100%; height:auto;">
                        </a>
                    </div>
                    <div class="promo-details col-xs-12">
                     <div class="store-name">
                            <h3><a href="{{ promotionable_url }}">{{ promotionable_name }}</a></h3>
                        </div>
                        <div class="name">
                            <h4><a href="../promotions/{{ slug }}">{{ name }}</a></h4>
                        </div>
                       
                        <div class="dates">
                            {{ start_date }} to {{ end_date }}
                        </div>
                        <div class="promotion-more">
                           <a href="../promotions/{{ slug }}">read more</a>
                        </div>
                        <div class="social-links">
                            <span class="social-share">share:</span>
                           <span><a href="http://www.facebook.com/sharer.php?u=http://halifaxcentre.kodekloud.io/promotions/{{slug}}" target="_blank"><img src="https://testbucketblurt.s3-us-west-2.amazonaws.com/sites/54205e6a6a616d39c5860000/251f914efb0a8216e2cd28dd4834e614/share_fb.png"></a></span>
                                        <span><a href="http://twitter.com/?status={{name}}%20%20http://halifaxcentre.kodekloud.io/promotions/{{slug}}" target="_blank"><img src="https://testbucketblurt.s3-us-west-2.amazonaws.com/sites/54205e6a6a616d39c5860000/251f914efb0a8216e2cd28dd4834e614/share_twit.png"></a></span>
                        </div>
                    </div>
                </li>
            </script>
            <div id='promotions_empty_section'>
                <h2 data-i18n="general.no_promotions" style="display:none"></h2>
            </div>
            
       


<script>


    $(document).ready(function() {
        
        function renderPageData(){
      
                 renderStoreWithImgTemplate('#promotion_item_template','#promotion_list','#promotions_not_empty_section','#promotions_empty_section',getStorePromotionsListByStoreName());
               
              //  renderPropertyStorePromotionsListTemplate('#promotion_item_template','#promotion_item_template_no_image','#promotion_list','#promotions_not_empty_section','#promotions_empty_section',"store",getStorePromotionsListByStoreName());
                //renderStoresWithPromotionsTemplate('#store_item_template','#stores_with_promotions');
        }
        
        loadMallData(renderPageData);
    });
    
    
    
    function renderStoreWithImgTemplate(template_id,html_id,not_empty_section_id,empty_section_id,promotions){
    var item_list = [];
    var template_html = $(template_id).html();
    Mustache.parse(template_html);

    
    $.each( promotions , function( key, val ) {
        localizeObject(val);
        var promotionable_name = "";
        var promotionable_url = "";
      if(val['promotionable_type'] == 'Store' ){
            var store_details = getStoreDetailsByID(val['promotionable_id']);
            if (store_details){
                localizeObject(store_details);
                val.store = store_details;
                val.promotionable_name = store_details.name;
                val.promotionable_url = "../stores/" + store_details.slug;
            }
            
            if(hasImage(store_details.store_front_url)){
                val.store_img = getImageURL(store_details.store_front_url);
            }else{
                val.store_img = changeStoreImgUrl(store_details);
  
            }
          var rendered = Mustache.render(template_html,val);
        item_list.push(rendered);
      }    
        
        



    });
    if(promotions.length > 0){
        $(not_empty_section_id).show();
        $(empty_section_id).hide();
        $(html_id).html(item_list.join(''));
    }else{
        $(not_empty_section_id).hide();
        $(empty_section_id).show();
    }
}

    
        function changeStoreImgUrl(storeObj){
    //   alert(storeObj.store_front_url);
    if(storeObj.store_front_url.indexOf("/store_fronts/original/missing.png") > -1 ){
     
       return "http://kodekloud.s3.amazonaws.com/sites/5438407c6e6f64462d020000/bc66d880720f58f49b267ae6fb920f74/default.jpg";
    } else {
         return "http://cdn.mallmaverick.com" + storeObj.store_front_url;
    }
}
    
</script>